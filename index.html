<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Spin & Toast ‚Äî Laurea Ingegneria Informatica</title>
  <meta name="description" content="Ruota della fortuna a tema Ingegneria Informatica per brindare alla laurea.">
  <style>
    :root{
      --bg:#0b0f14;         /* scuro elegante */
      --card:#111827;       /* ardesia */
      --accent:#22d3ee;     /* ciano */
      --accent2:#a78bfa;    /* lilla */
      --text:#e5e7eb;       /* grigio chiaro */
      --muted:#94a3b8;
      --good:#34d399; --warn:#fbbf24; --bad:#fb7185;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
      background:
        radial-gradient(1200px 800px at 80% -10%, #1f2937 0%, transparent 70%),
        radial-gradient(1000px 600px at -20% 110%, #0f172a 0%, transparent 70%),
        var(--bg);
      color:var(--text);
      display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .wrap{width:100%; max-width:1100px; display:grid; gap:20px}
    @media(min-width:900px){ .wrap{grid-template-columns:1.2fr .8fr} }

    .card{
      background:linear-gradient(180deg, #0f172a 0%, #0b1220 100%);
      border:1px solid #1f2937; border-radius:18px; padding:20px; box-shadow:0 10px 30px rgba(0,0,0,.35);
    }
    .title{font-size:clamp(22px,2.4vw,30px); letter-spacing:.3px; display:flex; align-items:center; gap:10px}
    .chip{font-size:12px; color:#0b1220; background:linear-gradient(90deg,var(--accent),var(--accent2));
      padding:4px 8px; border-radius:999px; font-weight:700; letter-spacing:.3px}
    .muted{color:var(--muted); font-size:14px}

    /* ===== Ruota ===== */
    .wheel-area{display:grid; grid-template-columns:1fr; gap:14px; place-items:center}
    .wheel-shell{
      position:relative; width:min(90vw,520px); aspect-ratio:1/1;
      display:grid; place-items:center;
    }
    .wheel{
      width:100%; height:100%; border-radius:50%;
      border:10px solid #0e1626; background:#0b1220;
      box-shadow:inset 0 0 40px rgba(255,255,255,.04), 0 20px 60px rgba(0,0,0,.4);
      position:relative; overflow:hidden; transition:filter .2s ease;
    }
    .wheel:after{ /* puntini bordo */
      content:""; position:absolute; inset:10px; border-radius:50%;
      border:2px dashed rgba(255,255,255,.08);
    }
    .pointer{
      position:absolute; top:-8px; left:50%; transform:translateX(-50%);
      width:0; height:0; border-left:16px solid transparent; border-right:16px solid transparent;
      border-bottom:26px solid var(--accent);
      filter:drop-shadow(0 4px 8px rgba(34,211,238,.35));
      z-index:4;
    }
    .segment-label{
      position:absolute; width:50%; left:50%; top:50%;
      transform-origin:0% 0%;
      display:flex; align-items:center; justify-content:flex-end; padding-right:18px;
      font-size:clamp(10px,1.3vw,14px); color:#dbeafe; text-transform:uppercase; letter-spacing:.5px;
      text-shadow:0 1px 2px rgba(0,0,0,.6);
      pointer-events:none; font-weight:700;
    }
    .btn{
      border:none; padding:12px 18px; border-radius:12px; font-weight:700; cursor:pointer;
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      color:#09111f; transition:transform .06s ease, box-shadow .2s ease;
      box-shadow:0 10px 20px rgba(167,139,250,.25);
    }
    .btn:active{ transform:translateY(1px) }

    /* ===== Popup ===== */
    .modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.5); z-index:20}
    .modal.show{display:grid}
    .modal-card{background:#0b1220; border:1px solid #1e2a44; border-radius:16px; max-width:560px; padding:22px; box-shadow:0 20px 60px rgba(0,0,0,.5)}
    .modal h2{margin:0 0 8px 0}
    .tag{display:inline-block; padding:4px 10px; border-radius:999px; border:1px solid #23314f; color:#9fb7ff; font-size:12px}
    .close{margin-top:14px; background:#111827; color:#e5e7eb}

    /* ===== Datasheet ===== */
    dl{display:grid; grid-template-columns:1fr; gap:8px}
    @media(min-width:520px){ dl{grid-template-columns:auto 1fr} }
    dt{color:#9ca3af}
    dd{margin:0; font-weight:600}

    /* ===== Console ===== */
    .console{background:#0a0f1b; border:1px solid #1f2a44; border-radius:12px; padding:12px; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size:13px; color:#d1fae5}
    .cursor{display:inline-block; width:9px; height:1em; background:#22d3ee; animation:blink 1s steps(1,end) infinite}
    @keyframes blink{50%{opacity:0}}

    /* ===== Canvas confetti ===== */
    #confetti{position:fixed; inset:0; pointer-events:none; z-index:15}
    footer{opacity:.7; font-size:12px; text-align:center; margin-top:8px}
    a{color:#a5b4fc}
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>

  <div class="wrap">
    <!-- Colonna sinistra: Ruota -->
    <section class="card">
      <div class="title">
        <span class="chip">LAUREA</span>
        <span>Spin &amp; Toast ‚Äî Ingegneria Informatica</span>
      </div>
      <p class="muted">Scansiona il QR e prova la ruota: ogni spin rivela un messaggio segreto (nerd-friendly) per brindare con me üéìü•Ç</p>

      <div class="wheel-area">
        <div class="wheel-shell">
          <div class="pointer"></div>
          <div class="wheel" id="wheel"></div>
        </div>
        <button class="btn" id="spinBtn" aria-label="Gira la ruota">Gira la ruota</button>
        <div class="console" id="console" aria-live="polite"></div>
        <footer>Tip: clicca di nuovo per un altro brindisi. Bevi responsabilmente.</footer>
      </div>
    </section>

    <!-- Colonna destra: Datasheet + Info -->
    <aside class="card">
      <div class="title"><span class="chip">DATASHEET</span><span>Ingegnere Bellissimo Spirit</span></div>
      <dl>
        <dt>Versione firmware</dt><dd>v1.0.0 ‚Äî Graduation Build</dd>
        <dt>Titolo</dt><dd>Laurea Magistrale in Ingegneria Informatica</dd>
        <dt>Gradazione (V<sub>alc</sub>)</dt><dd>~ 40% vol</dd>
        <dt>Input</dt><dd>Ghiaccio + Amici</dd>
        <dt>Output</dt><dd>Allegria + Abbracci</dd>
        <dt>Note</dt><dd><span class="tag">Don‚Äôt test in production üç∏</span></dd>
      </dl>

      <hr style="border-color:#1f2937; opacity:.5; margin:16px 0">
      <h3 style="margin:0 0 8px">Grazie per esserci</h3>
      <p class="muted">Se vuoi, lascia un messaggio: apri l‚Äôispezione della pagina e cerca l‚Äôeaster-egg üòâ</p>
      <!-- Easter egg per chi guarda il sorgente -->
      <!--
        Complimenti! Hai trovato l‚ÄôEaster Egg:
        println("Grazie per aver festeggiato con me! ‚Äî Ingegnere Bellissimo")
      -->
    </aside>
  </div>

  <!-- Modal messaggio -->
  <div class="modal" id="modal">
    <div class="modal-card">
      <h2 id="resultTitle">Brindisi!</h2>
      <p id="resultText" style="font-size:16px; line-height:1.5"></p>
      <button class="btn close" id="closeModal">Chiudi</button>
    </div>
  </div>

  <audio id="ding" preload="auto">
    <source src="data:audio/mp3;base64,//uQZAAAAAAAAAAAAAAAAAAAA..." type="audio/mp3">
    <!-- Nota: se vuoi, sostituisci con un tuo mp3 (breve ‚Äúding‚Äù). -->
  </audio>

  <script>
    /* ===========================
       Messaggi e segmenti ruota
       =========================== */
    const SEGMENTS = [
      { label: "Cheers.exe", msg: "Compilazione completata! Esecuzione brindisi avviata. ü•Ç" },
      { label: "No Bug", msg: "Nessun bug oggi: solo feature non documentate. üòé" },
      { label: "printf", msg: 'printf("Grazie per esserci!");' },
      { label: "99.9% Uptime", msg: "Affidabilit√† da datacenter, ma con cuore umano. ‚ù§Ô∏è" },
      { label: "Hot Reload", msg: "Refill automatico del bicchiere abilitato." },
      { label: "Merge", msg: "PR #2025: Laurea merged su main con approvazione di tutti. ‚úîÔ∏è" },
      { label: "Unit Test", msg: "Test superati: amicizia, pazienza, supporto. ‚úÖ" },
      { label: "Garbage Free", msg: "GC completata: solo ricordi belli in memoria. ‚ú®" },
    ];
    const wheel = document.getElementById('wheel');
    const spinBtn = document.getElementById('spinBtn');
    const con = document.getElementById('console');
    const modal = document.getElementById('modal');
    const resultTitle = document.getElementById('resultTitle');
    const resultText = document.getElementById('resultText');
    const closeModal = document.getElementById('closeModal');
    const ding = document.getElementById('ding');

    /* ===== Disegno dinamico dei segmenti ===== */
    const N = SEGMENTS.length;
    const slice = 360 / N;
    const colors = [
      '#22d3ee','#a78bfa','#38bdf8','#f472b6','#34d399','#fbbf24','#60a5fa','#c084fc'
    ];
    // Creiamo spicchi con conic-gradient e label ruotate
    function drawWheel(){
      const stops = SEGMENTS.map((_,i)=>{
        const c = colors[i % colors.length];
        const a0 = i*slice, a1 = (i+1)*slice;
        return `${c} ${a0}deg ${a1}deg`;
      }).join(', ');
      wheel.style.background = `conic-gradient(${stops})`;
      // Etichette
      wheel.querySelectorAll('.segment-label').forEach(el=>el.remove());
      SEGMENTS.forEach((s,i)=>{
        const label = document.createElement('div');
        label.className = 'segment-label';
        label.textContent = s.label;
        const angle = i*slice + slice/2; // met√† dello spicchio
        label.style.transform = `translate(-50%,-50%) rotate(${angle}deg)`;
        wheel.appendChild(label);
      });
    }
    drawWheel();

    /* ===== Effetto typing in console ===== */
    const bootLines = [
      '> build project --status success',
      '> deploy graduate.exe',
      '> cheers.exe'
    ];
    async function typeLines(lines, el){
      el.textContent = '';
      for(const line of lines){
        await type(line, el);
        el.appendChild(document.createElement('br'));
      }
      const cursor = document.createElement('span');
      cursor.className = 'cursor';
      el.appendChild(cursor);
    }
    function type(text, el){
      return new Promise(res=>{
        let i=0;
        const iv = setInterval(()=>{
          el.append(text[i++] || '');
          if(i===text.length){ clearInterval(iv); res(); }
        }, 18);
      });
    }
    typeLines(bootLines, con);

    /* ===== Logica di spin ===== */
    let spinning = false;
    let currentRotation = 0;
    function spin(){
      if(spinning) return;
      spinning = true;
      spinBtn.disabled = true;
      wheel.style.filter = 'brightness(1.05)';

      // rotazione target: giri completi + offset random
      const extraTurns = 4 + Math.floor(Math.random()*3); // 4-6 giri
      const targetSegment = Math.floor(Math.random()*N);  // index risultato
      // Notare che lo 0¬∞ √® a destra; il puntatore √® in alto ‚Üí invertiamo asse
      const segmentCenterDeg = (360 - (targetSegment*slice + slice/2)) % 360;
      const targetRotation = extraTurns*360 + segmentCenterDeg;

      animateSpin(currentRotation, currentRotation + targetRotation, 2200 + Math.random()*1200)
        .then(()=>{
          currentRotation = (currentRotation + targetRotation) % 360;
          wheel.style.filter = 'none';
          showResult(targetSegment);
          confettiBurst();
          try{ ding.currentTime = 0; ding.play().catch(()=>{}); }catch(e){}
        })
        .finally(()=>{
          spinning = false;
          spinBtn.disabled = false;
        });
    }

    function animateSpin(from, to, duration){
      return new Promise(res=>{
        const start = performance.now();
        (function frame(now){
          const t = Math.min(1, (now - start)/duration);
          // easing: easeOutCubic
          const eased = 1 - Math.pow(1 - t, 3);
          const val = from + (to - from)*eased;
          wheel.style.transform = `rotate(${val}deg)`;
          if(t < 1) requestAnimationFrame(frame); else res();
        })(start);
      });
    }

    function showResult(idx){
      const {label, msg} = SEGMENTS[idx];
      resultTitle.textContent = label;
      resultText.textContent = msg;
      modal.classList.add('show');
    }
    closeModal.addEventListener('click', ()=> modal.classList.remove('show'));
    modal.addEventListener('click', (e)=>{ if(e.target===modal) modal.classList.remove('show'); });
    spinBtn.addEventListener('click', spin);

    /* ===== Confetti minimal su canvas ===== */
    const canvas = document.getElementById('confetti');
    const ctx = canvas.getContext('2d');
    let W, H; function resize(){ W=canvas.width=innerWidth; H=canvas.height=innerHeight; }
    addEventListener('resize', resize); resize();
    let confetti = [];
    function confettiBurst(){
      const n = 140;
      for(let i=0;i<n;i++){
        confetti.push({
          x: W/2, y: 80, r: 2+Math.random()*4,
          vx: (Math.random()-0.5)*6, vy: (Math.random()*-6)-2,
          g: 0.15 + Math.random()*0.2,
          life: 120 + Math.random()*60,
          color: colors[Math.floor(Math.random()*colors.length)]
        });
      }
    }
    function tick(){
      ctx.clearRect(0,0,W,H);
      confetti = confetti.filter(p=>p.life>0);
      for(const p of confetti){
        p.life--;
        p.vx *= 0.995; p.vy += p.g;
        p.x += p.vx; p.y += p.vy;
        ctx.fillStyle = p.color;
        ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill();
      }
      requestAnimationFrame(tick);
    }
    tick();
  </script>
</body>
</html>
